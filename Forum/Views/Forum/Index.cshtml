@model Forum.Models.ViewModels.MainTopicViewModel

@{
    ViewData["Title"] = "Forum";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


    @(Html.DevExtreme().TreeList<Forum.Models.ViewModels.MainTopicViewModel>()
    .ID("forum-tree-list")
    .DataSource(ds => ds.WebApi()
        .Controller("Admin1")
        .LoadAction("GetMainTopics")
        .InsertAction("InsertTask")
        .UpdateAction("UpdateTask")
        .DeleteAction("DeleteTask")
        .Key("MainTopicId")
    )
    .RemoteOperations(r => r.Filtering(true).Sorting(true).Grouping(true))
    .KeyExpr("MainTopicId")
    .ParentIdExpr("ParentIdFK")
    .HasItemsExpr("HasItems")
    .ExpandedRowKeys(new[] { 1, 2 })
    .SearchPanel(seachPanel => seachPanel.Visible(true))
    .HeaderFilter(headerFilter => headerFilter.Visible(true))
    .Editing(editing => editing
        .Mode(GridEditMode.Row)
        .AllowAdding(true)
        .AllowUpdating(true)
        .AllowDeleting(true)
    )
    .ShowRowLines(true)
    .ShowBorders(true)
    .ColumnAutoWidth(true)
    .WordWrapEnabled(true)
    .Columns(columns => {
        columns.AddFor(m => m.Title).MinWidth(250);
        columns.AddFor(m => m.Description);
        columns.AddFor(x => x.DisplayOrder);
    })
    .OnInitNewRow("treeList_onInitNewRow")
)

<script>
    function treeList_onInitNewRow(e) {
        e.data.Task_Status = "Not Started";
        e.data.Task_Start_Date = new Date();
        e.data.Task_Due_Date = new Date();
    }
</script>